[build]
builder = "DOCKERFILE"
dockerfilePath = "Dockerfile"

[deploy]
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 3
healthcheckPath = "/api/actuator/health"
healthcheckTimeout = 100

[environments]
  [environments.production]
    variables = [
      "SPRING_PROFILES_ACTIVE=prod",
      "SERVER_PORT=${{PORT}}",
      "CORS_ALLOWED_ORIGINS=https://invoicing-system-production.up.railway.app",
      "DATABASE_URL=jdbc:postgresql://${{Postgres.HOST}}:${{Postgres.PORT}}/${{Postgres.DATABASE}}",
      "DATABASE_USERNAME=${{Postgres.USER}}",
      "DATABASE_PASSWORD=${{Postgres.PASSWORD}}"
    ]

[service]
name = "invoicing-api"
type = "web"